## 쓰레드

- 쓰레드는 코드를 한 줄 한 줄 순차적으로 실행
- 요청 하나가 지연될 경우 그 뒤의 요청을 수행할 수 없음

![image](https://user-images.githubusercontent.com/81701494/151080306-b00feae2-45ad-4458-9ff0-725945ef1c10.png)

## 멀티쓰레드

- 그럼 요청이 들어올 때마다 쓰레드를 생성해서 할당하자~

![image](https://user-images.githubusercontent.com/81701494/151080281-826dd6ab-b63b-4c4d-be96-7e070f384483.png)

- 하나의 쓰레드가 지연되어도 나머지 쓰레드는 정상적으로 작동한다.
- 하지만 쓰레드의 생성 비용은 매우 크다. 요청이 너무 많아지면 CPU에 과부하가 생겨 서버가 사망할 수 있다.



## 쓰레드풀
![image](https://user-images.githubusercontent.com/81701494/151080330-7feb59cf-c7c3-40d7-a62f-b7ce32811815.png)

- 미리 적정량(디폴트 200개)의 쓰레드를 미리 생성해놓고 보관한다.
- 쓰레드가 필요한 경우에는 이미 생성된 쓰레드를 할당한다. 모든 쓰레드가 사용중인 경우에는 기다린다.
- 쓰레드가 미리 생성되어 있으므로 쓰레드 생성비용이 절약된다. 많은 요청이 들어오는 경우에도 안정적으로 작동한다.
- CPU를 적당히 사용하는 쓰레드의 적정량을 찾는 것이 중요. 성능 테스트를 통해 산출한다. (아파치 ab, 제이미터, nGrinder)



## 멀티쓰레드 개발

- 기본적으로 멀티쓰레드 부분은 WAS가 처리해준다.
- 우리는 싱글 쓰레드 프로그래밍을 하듯이 개발하면 된다.
- 멀티쓰레드 환경이므로 싱글톤 객체(서블릿, 스프링 빈 등)는 주의해서 사용한다.

